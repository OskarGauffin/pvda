<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pvda">
<title>Disproportionality analysis • pvda</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Disproportionality analysis">
<meta property="og:description" content="pvda">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pvda</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Disproportionality_analysis.html">Disproportionality analysis</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Disproportionality analysis</h1>
            
      
      
      <div class="d-none name"><code>Disproportionality_analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>During the life cycle of a medicinal product, knowledge of the safety
profile continues to accumulate post market introduction. Adverse event
reports collected through spontaneous reporting play an instrumental
part in this development.</p>
<p>Adverse event report databases often cover a wide range of drugs and
events, beyond what can be feasibly monitored through manual work.
Disproportionality analysis is thus often used to highlight
drug-event-combinations of potential interest for further qualitative
manual case-by-case assessment.</p>
<p>The <code>pvda</code> package provides three disproportionality
estimators: the proportional reporting rate (PRR), the reporting odds
ratio (ROR) and the information component (IC). It takes report level
data as input, and outputs estimates for each drug-event-combination,
possibly stratified by some variable of interest, e.g. age group and/or
sex.</p>
</div>
<div class="section level2">
<h2 id="running-a-disproportionality-analysis">Running a disproportionality analysis<a class="anchor" aria-label="anchor" href="#running-a-disproportionality-analysis"></a>
</h2>
<p>The workhorse of this package is the function <code>da</code>. The
<code>da</code>-function takes patient level data in a data frame as
input (here <code>drug_event_df</code>) and produces estimates and
summary counts as demonstrated below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da_1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">drug_event_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/da.html">da</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The <code>drug_event_df</code> is a simulated data set with drugs
named Drug_A - Drug_Z and events Event_1 - Event_1000. Further details
about the simulation are documented in the data object (execute
<code>?df_drug_event</code>).</p>
<div class="section level3">
<h3 id="specifying-the-column-names">Specifying the column names<a class="anchor" aria-label="anchor" href="#specifying-the-column-names"></a>
</h3>
<p>The da-function will examine the passed data set for column names
contained in the passed parameter list “df_colnames”. The default column
names are “report_id”, “drug” and “event”. If we rename the report-id
column in “drug_event_df” we need to specify the new name in the call to
da, as shown below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da_1</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">drug_event_df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>reportID <span class="op">=</span> <span class="va">report_id</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/da.html">da</a></span><span class="op">(</span>df_colnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>report_id <span class="op">=</span> <span class="st">"reportID"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarizing-and-printing-results">Summarizing and printing results<a class="anchor" aria-label="anchor" href="#summarizing-and-printing-results"></a>
</h3>
<p>The ‘da_1’ object can then be passed to a summary and a print
function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">da_1</span><span class="op">)</span></span></code></pre></div>
<p><img src="summary_console_printout.png" style="width:110.0%"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">da_1</span>, n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="print_console_printout.png" style="width:110.0%"></p>
<p>(Technical note: As printing of colors in the console is not easily
reproduced within this vignette , we provide screenshots when
applicable. )</p>
</div>
<div class="section level3">
<h3 id="passing-a-correctly-structured-input-data">Passing a correctly structured input data<a class="anchor" aria-label="anchor" href="#passing-a-correctly-structured-input-data"></a>
</h3>
<p>The input data needs to be in a report-level format. every line in
the data frame corresponds to a drug-event pair from a specific
report.</p>
<p>In the drug_event_df-example data, the first three rows of
drug_event_df are from the same report, with report_id = 1. The first
row reports a Drug_D and an adverse event named Event_5.The next three
rows are from another report, where for instance drug B has been
reported for two different events, event 15 and event 33. We can ignore
the group-column for now.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drug_event_df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##   report_id drug   event    group</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>         1 Drug_A Event_23     1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>         1 Drug_D Event_6      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>         1 Drug_E Event_8      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>         1 Drug_I Event_9      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>         2 Drug_B Event_2      0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>         2 Drug_G Event_13     0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="extracting-the-results">Extracting the results<a class="anchor" aria-label="anchor" href="#extracting-the-results"></a>
</h3>
<p>For covenience, the output object of da is a list of class “da”
containing two objects, the results (“da_df”) and the input parameters
(“input_params”). At some point you might want to extract the results or
the input parameters list, here we demonstrate some alternatives:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">da_1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "da_df"        "input_params"</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Different ways of extracting the results data frame</span></span>
<span><span class="co"># da_1$da_df</span></span>
<span><span class="co"># da_1[['da_df']]</span></span>
<span><span class="co"># da_1 |&gt; purrr::pluck("da_df")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="how-to-run-a-subgroup-analysis">How to run a subgroup analysis?<a class="anchor" aria-label="anchor" href="#how-to-run-a-subgroup-analysis"></a>
</h3>
<p>The <code>da</code> function builds a comparator from the passed
data, e.g. for <code>prr</code> by excluding the drug of interest from
the comparator, sometimes referred to as the background. This implies
that any subgroup analysis of e.g. specific age groups can be achieved
by creating a new data frame with the subgroup of interest, and then
passing it to <code>da</code>.</p>
<p>If a more exhaustive grouping is required, one can provide a grouping
variable <code>group_by</code> to <code>da</code>. This executes a call
to <code>da</code> for each grouping and return the results as a single
data frame. The grouping could for instance be age groups, sex,
countries, regions or a combination thereof, but needs to be passed as a
single variable (character or numeric).</p>
<p>The drug_event_df contains two groups, in the column named “group”.
We can pass “group” as the <code>group_by</code> parameter in
<code>df_colnames</code> as below.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drug_event_df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##   report_id drug   event    group</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>         1 Drug_A Event_23     1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>         1 Drug_D Event_6      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>         1 Drug_E Event_8      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>         1 Drug_I Event_9      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>         2 Drug_B Event_2      0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>         2 Drug_G Event_13     0</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da_grouped</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">drug_event_df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/da.html">da</a></span><span class="op">(</span>df_colnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group_by<span class="op">=</span><span class="st">"group"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">da_grouped</span><span class="op">$</span><span class="va">da_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1,808 × 24</span></span></span>
<span><span class="co">##    drug   event   group   obs exp_rrr ic2.5    ic ic97.5 exp_prr prr2.5   prr</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Drug_Z Event_1     0    45    26.5  0.3   0.75   1.14    23.4   1.54  1.92</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Drug_Z Event_1     1    43    29.1  0.09  0.56   0.96    26.5   1.28  1.63</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Drug_Z Event_2     0    33    24.6 -<span style="color: #BB0000;">0.12</span>  0.42   0.87    23.2   1.07  1.42</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Drug_Z Event_2     1    42    27.8  0.12  0.59   0.99    25.1   1.3   1.67</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Drug_V Event_2     0    34    26.0 -<span style="color: #BB0000;">0.14</span>  0.38   0.82    24.6   1.04  1.38</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Drug_V Event_2     1    46    31.0  0.12  0.56   0.95    27.8   1.3   1.66</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Drug_V Event_1     0    40    28.0  0.03  0.51   0.92    25.8   1.21  1.55</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Drug_V Event_1     1    42    32.4 -<span style="color: #BB0000;">0.1</span>   0.37   0.77    30.3   1.07  1.38</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Drug_U Event_2     0    42    31.5 -<span style="color: #BB0000;">0.06</span>  0.41   0.81    29.1   1.11  1.44</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Drug_U Event_2     1    37    26.8 -<span style="color: #BB0000;">0.04</span>  0.46   0.89    24.9   1.14  1.49</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1,798 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 13 more variables: prr97.5 &lt;dbl&gt;, exp_ror &lt;dbl&gt;, ror2.5 &lt;dbl&gt;, ror &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ror97.5 &lt;dbl&gt;, n_drug &lt;int&gt;, n_event &lt;int&gt;, n_tot &lt;int&gt;, n_event_prr &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   n_tot_prr &lt;int&gt;, b &lt;int&gt;, c &lt;int&gt;, d &lt;int&gt;</span></span></span></code></pre>
<p>In the output we note the third column is “group”, i.e. the column
name we passed. We also note that the drug-event-pairs are kept
together, e.g. first and second row contains the same
drug-event-combination, “Drug_Z” and “Event_1”. This is to simplify
comparisons within a drug-event-pair across different groups, e.g. if
the same pattern is seen across both males and females. The ordering of
the drug-events in the output is made by averaging the selected
disproportionality estimate (parameter <code>sort_by</code>), i.e. the
top two rows have the highest average “ic2.5”.</p>
</div>
</div>
<div class="section level2">
<h2 id="frequently-asked-questions">Frequently Asked Questions<a class="anchor" aria-label="anchor" href="#frequently-asked-questions"></a>
</h2>
<div class="section level3">
<h3 id="how-are-drug-event-pairs-occurrings-several-times-in-one-report-counted">How are drug-event pairs occurrings several times in one report
counted?<a class="anchor" aria-label="anchor" href="#how-are-drug-event-pairs-occurrings-several-times-in-one-report-counted"></a>
</h3>
<p>If the same drug-event pair occurs several times in one report, these
contributes to counts only once. That is, an observed count of five
means that there were five different reports containing the
drug-event-pair (at least once). It cannot be due to a single report
containing the same drug-event pair five times due to repeated events or
data quality issues. This is demonstrated below, where we duplicate the
first row of drug_event_df and still arrive at an observed count of
1.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_row</span> <span class="op">&lt;-</span> <span class="va">drug_event_df</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">first_row</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">first_row</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/da.html">da</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"da_df"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="how-is-the-expected-calculated">How is the expected calculated?<a class="anchor" aria-label="anchor" href="#how-is-the-expected-calculated"></a>
</h3>
<p>Detailed formulas for PRR, RRR and IC are documented within each
function ( “?prr”, “?rrr”, “?ic”), but overall one can note that all
expected counts are derived from the same contingency table of those who
were and were not exposed to the drug, and did and did not experience
the adverse event. The sample used for the contingency table is the data
frame passed to the da function. See also the grouping parameter.</p>
</div>
<div class="section level3">
<h3 id="where-is-exp_ic-in-the-output-or-what-is-exp_prr">Where is exp_ic in the output, or what is exp_prr?<a class="anchor" aria-label="anchor" href="#where-is-exp_ic-in-the-output-or-what-is-exp_prr"></a>
</h3>
<p>A common question regards the output column names, ic is preceded by
“exp_prr”. This is as the information component uses the same expected
count as the Relative Reporting Rate (RRR), which is perhaps more well
known in the pharmacovigilande community.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note the fourth column name:</span></span>
<span><span class="va">drug_event_df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/da.html">da</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"da_df"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">drug</span><span class="op">:</span><span class="va">ic97.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1,306 × 7</span></span></span>
<span><span class="co">##   drug   event     obs exp_rrr ic2.5    ic ic97.5</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Drug_Z Event_1    88    55.6  0.34  0.66   0.94</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1,305 more rows</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="rule-of-n">Rule of N<a class="anchor" aria-label="anchor" href="#rule-of-n"></a>
</h3>
<p>The function <code>da</code> has several input parameters. One is the
<code>rule_of_N</code>, by default set to 3, which is sometimes referred
to as “rule of three”. This sets ROR and PRR-values to NA if the
observed count is less than the specified N. For completeness, note that
the default shrinkage in the IC acts as a built in ‘rule of 3’,
(i.e. the shrinkage of +0.5 prevents the lower bound to exceed 0 at the
default significance level of 95%).</p>
</div>
<div class="section level3">
<h3 id="controlling-the-number-of-digits">Controlling the number of digits<a class="anchor" aria-label="anchor" href="#controlling-the-number-of-digits"></a>
</h3>
<p>The function <code>da</code> has a parameter
<code>number_of_digits</code> controls the rounding of non-count values
in the output, including all expected counts, uncertainty bounds and
point estimates.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drug_event_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/da.html">da</a></span><span class="op">(</span></span>
<span>    rule_of_N <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    number_of_digits <span class="op">=</span> <span class="fl">8</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="print_console_many_digits.png"></p>
</div>
<div class="section level3">
<h3 id="can-i-use-pvda-to-get-ic-prr-or-ror-when-i-already-have-the-observed-and-expected-counts">Can I use pvda to get IC, PRR or ROR, when I already have the
observed and expected counts?<a class="anchor" aria-label="anchor" href="#can-i-use-pvda-to-get-ic-prr-or-ror-when-i-already-have-the-observed-and-expected-counts"></a>
</h3>
<p>Yes, you can calculate point estimates with confidence or credibility
intervals for specific drug-event-combination if you already have the
number of observed reports, and other required counts such as the
database total count, number of reports with the exposure and number of
reports with the event. This can be helpful for instance to quality
check results, e.g. from papers or other software.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prr.html">prr</a></span><span class="op">(</span>obs <span class="op">=</span> <span class="fl">10</span>, n_drug <span class="op">=</span> <span class="fl">1000</span>, n_event_prr <span class="op">=</span> <span class="fl">200</span>, n_tot_prr <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   prr2.5   prr prr97.5</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  0.266   0.5   0.940</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ror.html">ror</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">10</span>, b <span class="op">=</span> <span class="fl">20</span>, c <span class="op">=</span> <span class="fl">200</span>, d <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   ror2.5   ror ror97.5</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   11.6    25    54.1</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ic.html">ic</a></span><span class="op">(</span>obs <span class="op">=</span> <span class="fl">10</span>, exp <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##     ic2.5    ic ic97.5</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">3</span> 0.933   1.69</span></span></code></pre>
<p>For further details on the specific input parameters, consult the
documentation of each function.</p>
</div>
<div class="section level3">
<h3 id="how-fast-is-pvda">How fast is pvda?<a class="anchor" aria-label="anchor" href="#how-fast-is-pvda"></a>
</h3>
<p>The data.table-package (through “dtplyr”) is used for fast execution.
A test of the execution speed was made using the <code>vaers</code> R
package, available on <a href="https://gitlab.com/iembry/vaers.git" class="external-link">gitlab</a>. The
<code>vaers</code> package contains data from VAERS from years 1990 -
2018, resulting in 4 146 778 rows to be processed by <code>da</code> in
<code>pvda</code>. Execution time on a regular laptop was less than 10
seconds.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Oskar Gauffin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
