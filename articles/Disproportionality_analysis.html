<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pvutils">
<title>Disproportionality_analysis using pvutils • pvutils</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Disproportionality_analysis using pvutils">
<meta property="og:description" content="pvutils">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pvutils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Disproportionality_analysis.html">Disproportionality_analysis using pvutils</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Disproportionality_analysis using pvutils</h1>
            
      
      
      <div class="d-none name"><code>Disproportionality_analysis.Rmd</code></div>
    </div>

    
    
<p>During the life cycle of a medicinal product, knowledge of the safety
profile continues to accumulate post market introduction. One way to
collect such information of suspected adverse events is to fill in a
spontaneous report and send it to a national regulatory authority, such
as the FDA, MHRA, PMDA, MPA, etc.</p>
<p>Given a large set of reports covering a multitude of drugs and
adverse events, disproportionality analysis is a data driven tool to
identify drug-event-combinations of potential interest for further
qualitative manual case-by-case assessment.</p>
<p>The pvutils package provides three different disproportionality
estimators, the proportional reporting rate (PRR), the reporting odds
ratio (ROR) and the information component (IC).</p>
<p>A first use-case for these functions is to provide a way to calculate
confidence or credibility intervals for different point estimates. For
instance, incorrectly calculated IC-values has sometimes been published
in scientific publications.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://oskargauffin.github.io/pvutils/">pvutils</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Report issues at https://github.com/OskarGauffin/pvutils</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ic.html">ic</a></span><span class="op">(</span>obs <span class="op">=</span> <span class="fl">10</span>, exp <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   ic_lower    ic ic_upper</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">3</span> 0.933     1.69</span></span></code></pre>
<p>The next question is how to calculate the exp-parameter, passed in
the ic-function as 5 above. This is the second use-case, to calculate
disproportionality from raw data.</p>
<div class="section level2">
<h2 id="disproportionality-from-raw-data">Disproportionality from raw data<a class="anchor" aria-label="anchor" href="#disproportionality-from-raw-data"></a>
</h2>
<p>A simulated data set ‘drug_event_df’ is included in the package. To
avoid any proprietary issues, drugs are named as Drug_A - Drug_Z, and
events are named Event_1 - Event_1000. The package passes this data to a
“add_expected_counts”-function, which provides the required expected
counts. These are then passed to “add_disprop_est” which adds point and
interval estimates to the resulting data frame.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drug_event_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_expected_counts.html">add_expected_counts</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_disprop_est.html">add_disprop_est</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1,279 × 23</span></span></span>
<span><span class="co">##    drug   event   obs n_drug n_event n_tot exp_rrr n_eve…¹ n_tot…² exp_prr     b</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Drug_A Even…    21    359     174  <span style="text-decoration: underline;">1</span>000    62.5     153     641    85.7   338</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Drug_A Even…    21    359     155  <span style="text-decoration: underline;">1</span>000    55.6     134     641    75.0   338</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Drug_C Even…    21    298     174  <span style="text-decoration: underline;">1</span>000    51.9     153     702    64.9   277</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Drug_E Even…    21    279     186  <span style="text-decoration: underline;">1</span>000    51.9     165     721    63.8   258</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Drug_D Even…    20    275     163  <span style="text-decoration: underline;">1</span>000    44.8     143     725    54.2   255</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Drug_A Even…    19    359     186  <span style="text-decoration: underline;">1</span>000    66.8     167     641    93.5   340</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Drug_A Even…    19    359     138  <span style="text-decoration: underline;">1</span>000    49.5     119     641    66.6   340</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Drug_C Even…    19    298     163  <span style="text-decoration: underline;">1</span>000    48.6     144     702    61.1   279</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Drug_E Even…    19    279     138  <span style="text-decoration: underline;">1</span>000    38.5     119     721    46.0   260</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Drug_A Even…    18    359     163  <span style="text-decoration: underline;">1</span>000    58.5     145     641    81.2   341</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 1,269 more rows, 12 more variables: c &lt;int&gt;, d &lt;int&gt;, exp_ror &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ic_lower &lt;dbl&gt;, ic &lt;dbl&gt;, ic_upper &lt;dbl&gt;, prr_lower &lt;dbl&gt;, prr &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   prr_upper &lt;dbl&gt;, ror_lower &lt;dbl&gt;, ror &lt;dbl&gt;, ror_upper &lt;dbl&gt;, and</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   abbreviated variable names ¹​n_event_prr, ²​n_tot_prr</span></span></span></code></pre>
<p>We will now step through each of these three steps in further detail.
It is important that the structure of the raw data is compliant with
what pvutils expects. Every line in the passed data corresponds to a
reported drug-event-combination. The same report may contain several
such, as rows with repeated report_ids indicate.</p>
<p>To be explicit, the first three rows of drug_event_df are from the
same report, with report_id = 1. The first row reports a Drug_D and an
adverse event named Event_5.The next five rows are from another report,
where for instance drug B has been reported for two different events,
event 15 and event 33.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drug_event_df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">##   report_id drug   event   </span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>         1 Drug_D Event_5 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>         1 Drug_G Event_56</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>         1 Drug_O Event_89</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>         2 Drug_A Event_33</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>         2 Drug_B Event_15</span></span></code></pre>
<p>For timely execution, pvutils uses the data.table-package (through
the dtplyr-wrapper).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://oskargauffin.github.io/pvutils/">pvutils</a></span><span class="op">)</span></span></code></pre></div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Oskar Gauffin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
